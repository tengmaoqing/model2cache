/*!
 * VueDataCache.js v0.1.4
 * (c) 2014-2020 Teng Mao Qing
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).VueDataCache=e()}(this,function(){"use strict";var t=Array.isArray,e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},r="object"==typeof e&&e&&e.Object===Object&&e,n="object"==typeof self&&self&&self.Object===Object&&self,o=r||n||Function("return this")(),a=o.Symbol,i=Object.prototype,c=i.hasOwnProperty,s=i.toString,u=a?a.toStringTag:void 0;var h=function(t){var e=c.call(t,u),r=t[u];try{t[u]=void 0;var n=!0}catch(t){}var o=s.call(t);return n&&(e?t[u]=r:delete t[u]),o},l=Object.prototype.toString;var f=function(t){return l.call(t)},p="[object Null]",v="[object Undefined]",y=a?a.toStringTag:void 0;var d=function(t){return null==t?void 0===t?v:p:y&&y in Object(t)?h(t):f(t)};var _=function(t){return null!=t&&"object"==typeof t},g="[object Symbol]";var b=function(t){return"symbol"==typeof t||_(t)&&d(t)==g},m=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,O=/^\w*$/;var j=function(e,r){if(t(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!b(e))||O.test(e)||!m.test(e)||null!=r&&e in Object(r)};var w=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},$="[object AsyncFunction]",S="[object Function]",K="[object GeneratorFunction]",D="[object Proxy]";var P,x=function(t){if(!w(t))return!1;var e=d(t);return e==S||e==K||e==$||e==D},C=o["__core-js_shared__"],z=(P=/[^.]+$/.exec(C&&C.keys&&C.keys.IE_PROTO||""))?"Symbol(src)_1."+P:"";var A=function(t){return!!z&&z in t},M=Function.prototype.toString;var L=function(t){if(null!=t){try{return M.call(t)}catch(t){}try{return t+""}catch(t){}}return""},k=/^\[object .+?Constructor\]$/,E=Function.prototype,T=Object.prototype,F=E.toString,I=T.hasOwnProperty,N=RegExp("^"+F.call(I).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var J=function(t){return!(!w(t)||A(t))&&(x(t)?N:k).test(L(t))};var R=function(t,e){return null==t?void 0:t[e]};var U=function(t,e){var r=R(t,e);return J(r)?r:void 0},G=U(Object,"create");var Q=function(){this.__data__=G?G(null):{},this.size=0};var V=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Y="__lodash_hash_undefined__",q=Object.prototype.hasOwnProperty;var B=function(t){var e=this.__data__;if(G){var r=e[t];return r===Y?void 0:r}return q.call(e,t)?e[t]:void 0},H=Object.prototype.hasOwnProperty;var W=function(t){var e=this.__data__;return G?void 0!==e[t]:H.call(e,t)},X="__lodash_hash_undefined__";var Z=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=G&&void 0===e?X:e,this};function tt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}tt.prototype.clear=Q,tt.prototype.delete=V,tt.prototype.get=B,tt.prototype.has=W,tt.prototype.set=Z;var et=tt;var rt=function(){this.__data__=[],this.size=0};var nt=function(t,e){return t===e||t!=t&&e!=e};var ot=function(t,e){for(var r=t.length;r--;)if(nt(t[r][0],e))return r;return-1},at=Array.prototype.splice;var it=function(t){var e=this.__data__,r=ot(e,t);return!(r<0||(r==e.length-1?e.pop():at.call(e,r,1),--this.size,0))};var ct=function(t){var e=this.__data__,r=ot(e,t);return r<0?void 0:e[r][1]};var st=function(t){return ot(this.__data__,t)>-1};var ut=function(t,e){var r=this.__data__,n=ot(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};function ht(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}ht.prototype.clear=rt,ht.prototype.delete=it,ht.prototype.get=ct,ht.prototype.has=st,ht.prototype.set=ut;var lt=ht,ft=U(o,"Map");var pt=function(){this.size=0,this.__data__={hash:new et,map:new(ft||lt),string:new et}};var vt=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};var yt=function(t,e){var r=t.__data__;return vt(e)?r["string"==typeof e?"string":"hash"]:r.map};var dt=function(t){var e=yt(this,t).delete(t);return this.size-=e?1:0,e};var _t=function(t){return yt(this,t).get(t)};var gt=function(t){return yt(this,t).has(t)};var bt=function(t,e){var r=yt(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};function mt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}mt.prototype.clear=pt,mt.prototype.delete=dt,mt.prototype.get=_t,mt.prototype.has=gt,mt.prototype.set=bt;var Ot=mt,jt="Expected a function";function wt(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(jt);var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],a=r.cache;if(a.has(o))return a.get(o);var i=t.apply(this,n);return r.cache=a.set(o,i)||a,i};return r.cache=new(wt.Cache||Ot),r}wt.Cache=Ot;var $t=wt,St=500;var Kt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Dt=/\\(\\)?/g,Pt=function(t){var e=$t(t,function(t){return r.size===St&&r.clear(),t}),r=e.cache;return e}(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(Kt,function(t,r,n,o){e.push(n?o.replace(Dt,"$1"):r||t)}),e});var xt=function(t,e){for(var r=-1,n=null==t?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o},Ct=1/0,zt=a?a.prototype:void 0,At=zt?zt.toString:void 0;var Mt=function e(r){if("string"==typeof r)return r;if(t(r))return xt(r,e)+"";if(b(r))return At?At.call(r):"";var n=r+"";return"0"==n&&1/r==-Ct?"-0":n};var Lt=function(t){return null==t?"":Mt(t)};var kt=function(e,r){return t(e)?e:j(e,r)?[e]:Pt(Lt(e))},Et=1/0;var Tt=function(t){if("string"==typeof t||b(t))return t;var e=t+"";return"0"==e&&1/t==-Et?"-0":e};var Ft=function(t,e){for(var r=0,n=(e=kt(e,t)).length;null!=t&&r<n;)t=t[Tt(e[r++])];return r&&r==n?t:void 0};var It=function(t,e,r){var n=null==t?void 0:Ft(t,e);return void 0===n?r:n},Nt=function(){try{var t=U(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();var Jt=function(t,e,r){"__proto__"==e&&Nt?Nt(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r},Rt=Object.prototype.hasOwnProperty;var Ut=function(t,e,r){var n=t[e];Rt.call(t,e)&&nt(n,r)&&(void 0!==r||e in t)||Jt(t,e,r)},Gt=9007199254740991,Qt=/^(?:0|[1-9]\d*)$/;var Vt=function(t,e){var r=typeof t;return!!(e=null==e?Gt:e)&&("number"==r||"symbol"!=r&&Qt.test(t))&&t>-1&&t%1==0&&t<e};var Yt=function(t,e,r,n){if(!w(t))return t;for(var o=-1,a=(e=kt(e,t)).length,i=a-1,c=t;null!=c&&++o<a;){var s=Tt(e[o]),u=r;if(o!=i){var h=c[s];void 0===(u=n?n(h,s,c):void 0)&&(u=w(h)?h:Vt(e[o+1])?[]:{})}Ut(c,s,u),c=c[s]}return t};var qt=function(t,e,r){return null==t?t:Yt(t,e,r)};const Bt="__TMQ_DEFAULT_KEY__",Ht={},Wt=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];console.log("[cache-data]:",...e)};class Xt{constructor(){this.init(...arguments)}init(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.isdebug=e.debug,this.vm=t,this.$cacheOptions=t.$options[e.optionKey],Array.isArray(this.$cacheOptions)&&(this.$cacheOptions={cacheKeys:this.$cacheOptions||[]}),this.cacheKeys=this.$cacheOptions.cacheKeys.map(t=>{let e={key:"",useLocalStore:!0};return"string"==typeof t?e.key=t:Object.assign(e,t),e})||[],this.cachePrefix=this.$cacheOptions.cachePrefix||e.cachePrefix||Bt,this.MemCache=Ht}getKeyConfig(t){return this.cacheKeys.find(e=>e.key===t)||{}}getLocalData(t){const e=localStorage.getItem("".concat(this.cachePrefix).concat(t));return e?JSON.parse(e):It(this.vm,t)}getMemData(t){return this.MemCache[t]}getData(t){const{useLocalStore:e}=this.getKeyConfig(t);if(e)return this.getLocalData(t);this.getMemData(t)}setLocalDate(t,e){localStorage.setItem("".concat(this.cachePrefix).concat(t),JSON.stringify(e))}setMemData(t,e){this.MemCache[t]=e}setData(t,e){const{useLocalStore:r}=this.getKeyConfig(t);r?this.setLocalDate(t,e):this.setMemData(t,e)}applyData(){this.cacheKeys.forEach(t=>{let{key:e}=t;const r=this.getData(e);qt(this.vm,e,r)})}watchData(){this.watchs=this.cacheKeys.map(t=>{let{key:e}=t;return this.vm.$watch(e,t=>{this.isdebug&&Wt("watch",e,t),this.setData(e,t)})})}destory(){this.watchs.forEach(t=>t())}deleteKey(t){const{useLocalStore:e}=this.getKeyConfig(t);e?localStorage.removeItem("".concat(this.cachePrefix).concat(t)):this.MemCache[t]=null}clear(){this.cacheKeys.map(t=>{let{key:e}=t;this.deleteKey(e)})}reset(){}}return{install(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.optionKey=e.optionKey||"cache",t.mixin({mounted(){this.$options[e.optionKey]&&(this.$autoSave=new Xt(this,e),this.$autoSave.applyData(),this.$autoSave.watchData())},destroyed(){this.$options[e.optionKey]&&this.$autoSave.destory()}})}}});